[{"insert":"Sub StockMarket_Analysis()\r\n\r\n'Define all  variables\r\n'--------------------------------------------------\r\n\r\n'Define a variable for Ticker\r\n\r\nDim Ticker As String\r\n\r\n'Define a variable for year open\r\n\r\nDim year_open As Double\r\n\r\n'Define avariable for year close\r\n\r\nDim year_close As Double\r\n\r\n'Define a variable for yearly change\r\n\r\nDim Yearly_Change As Double\r\n\r\n'Define a variable for total stock volume\r\n\r\nDim Total_Stock_Volume As Double\r\n\r\n'Define a variable for percent change\r\n\r\nDim Percent_Change As Double\r\n\r\n'Define a variable to set up a row to start\r\n\r\nDim start_data As Integer\r\n\r\n'Define variable of the worksheet to excute the code in all work sheet at once in the workbook\r\n\r\nDim ws As Worksheet\r\n\r\n' Initiate or loop in all worksheet to excute the code once\r\n'--------------------------------------------------\r\n\r\nFor Each ws In Worksheets\r\n\r\n    'Assign a column header for every task we are going perform\r\n    \r\n    ws.Range(\"I1\").Value = \"Ticker\"\r\n    ws.Range(\"J1\").Value = \"Yearly Change\"\r\n    ws.Range(\"K1\").Value = \"Percent Change\"\r\n    ws.Range(\"L1\").Value = \"Total Stock Volume\"\r\n\r\n    'Assign intiger for the loop to start\r\n    start_data = 2\r\n    previous_i = 1\r\n    Total_Stock_Volume = 0\r\n    \r\n    'Go to the last row of coumn A\r\n    \r\n    EndRow = ws.Cells(Rows.Count, \"A\").End(xlUp).Row\r\n\r\n        'For each Ticker summrize and loop the yearly change, percent change, and total stock volume\r\n        \r\n        For i = 2 To EndRow\r\n            \r\n            'If Tickersymbol change or not equal to the previous one excute to record\r\n            \r\n            If ws.Cells(i + 1, 1).Value <> ws.Cells(i, 1).Value Then\r\n            \r\n            'Get the Tickersymbol\r\n            \r\n            Ticker = ws.Cells(i, 1).Value\r\n            \r\n            'Intiate the variable to go to the next Ticker Alphabet\r\n            \r\n            previous_i = previous_i + 1\r\n            \r\n            ' Get the value first day open form the column 3 or \"C\" and last day close of the year on column 6 or \"F\"\r\n            \r\n            year_open = ws.Cells(previous_i, 3).Value\r\n            year_close = ws.Cells(i, 6).Value\r\n            \r\n            ' A for loop to sum the total stock volume using vol which is found in column 7 or \"G\"\r\n            \r\n            For j = previous_i To i\r\n            \r\n                Total_Stock_Volume = Total_Stock_Volume + ws.Cells(j, 7).Value\r\n                \r\n            Next j\r\n            \r\n            'When the loop get the value zero open the data\r\n            \r\n            If year_open = 0 Then\r\n            \r\n                Percent_Change = year_close\r\n                \r\n            Else\r\n                Yearly_Change = year_close - year_open\r\n                \r\n                Percent_Change = Yearly_Change / year_open\r\n                \r\n            End If\r\n         '--------------------------------------------------\r\n         \r\n            'Get the values in the worksheet summery table\r\n            \r\n            ws.Cells(start_data, 9).Value = Ticker\r\n            ws.Cells(start_data, 10).Value = Yearly_Change\r\n            ws.Cells(start_data, 11).Value = Percent_Change\r\n            \r\n            'Use percentage format\r\n        \r\n            ws.Cells(start_data, 11).NumberFormat = \"0.00%\"\r\n            ws.Cells(start_data, 12).Value = Total_Stock_Volume\r\n            \r\n            'In the data summery when the first row task completed go to the next row\r\n            \r\n            start_data = start_data + 1\r\n            \r\n            'Get back the variable to zero\r\n            \r\n            Total_Stock_Volume = 0\r\n            Yearly_Change = 0\r\n            Percent_Change = 0\r\n            \r\n            'Move i number to variable previous_i\r\n            previous_i = i\r\n        \r\n        End If\r\n\r\n    'Done the loop\r\n    \r\n    Next i\r\n    \r\n'The second summery table\r\n  '--------------------------------------------------\r\n    \r\n    'Go to the last row of column k\r\n    \r\n    kEndRow = ws.Cells(Rows.Count, \"K\").End(xlUp).Row\r\n    \r\n    'Define variable to initiate the second summery table value\r\n\r\n    Increase = 0\r\n    Decrease = 0\r\n    Greatest = 0\r\n    \r\n        'find max/min for percentage change and the max volume Loop\r\n        For k = 3 To kEndRow\r\n        \r\n            'Define previous increment to check\r\n            last_k = k - 1\r\n                        \r\n            'Define current row for percentage\r\n            current_k = ws.Cells(k, 11).Value\r\n            \r\n            'Define Previous row for percentage\r\n            prevous_k = ws.Cells(last_k, 11).Value\r\n            \r\n            'greatest total volume row\r\n            volume = ws.Cells(k, 12).Value\r\n            \r\n            'Prevous greatest volume row\r\n            prevous_vol = ws.Cells(last_k, 12).Value\r\n            \r\n   '--------------------------------------------------\r\n            \r\n            'Find the increase\r\n            If Increase > current_k And Increase > prevous_k Then\r\n                \r\n                Increase = Increase\r\n                \r\n                'define name for increase percentage\r\n                'increase_name = ws.Cells(k, 9).Value\r\n                \r\n            ElseIf current_k > Increase And current_k > prevous_k Then\r\n                \r\n                Increase = current_k\r\n                \r\n                'define name for increase percentage\r\n                increase_name = ws.Cells(k, 9).Value\r\n                \r\n            ElseIf prevous_k > Increase And prevous_k > current_k Then\r\n            \r\n                Increase = prevous_k\r\n                \r\n                'define name for increase percentage\r\n                increase_name = ws.Cells(last_k, 9).Value\r\n                \r\n            End If\r\n                \r\n       '--------------------------------------------------\r\n            'Find the decrease\r\n            \r\n            If Decrease < current_k And Decrease < prevous_k Then\r\n                \r\n                'Define decrease as decrease\r\n                \r\n                Decrease = Decrease\r\n                \r\n                'Define name for increase percentage\r\n    \r\n            ElseIf current_k < Increase And current_k < prevous_k Then\r\n                \r\n                Decrease = current_k\r\n                \r\n              \r\n                decrease_name = ws.Cells(k, 9).Value\r\n                \r\n            ElseIf prevous_k < Increase And prevous_k < current_k Then\r\n            \r\n                Decrease = prevous_k\r\n\r\n                decrease_name = ws.Cells(last_k, 9).Value\r\n                \r\n            End If\r\n            \r\n       '--------------------------------------------------\r\n           'Find the greatest volume\r\n           \r\n            If Greatest > volume And Greatest > prevous_vol Then\r\n            \r\n                Greatest = Greatest\r\n                \r\n                'define name for greatest volume\r\n                'greatest_name = ws.Cells(k, 9).Value\r\n            \r\n            ElseIf volume > Greatest And volume > prevous_vol Then\r\n            \r\n                Greatest = volume\r\n                \r\n                'define name for greatest volume\r\n                greatest_name = ws.Cells(k, 9).Value\r\n                \r\n            ElseIf prevous_vol > Greatest And prevous_vol > volume Then\r\n                \r\n                Greatest = prevous_vol\r\n                \r\n                'define name for greatest volume\r\n                greatest_name = ws.Cells(last_k, 9).Value\r\n                \r\n            End If\r\n            \r\n        Next k\r\n  '--------------------------------------------------\r\n    ' Assign names for greatest increase,greatest decrease, and  greatest volume\r\n    \r\n    ws.Range(\"N1\").Value = \"Column Name\"\r\n    ws.Range(\"N2\").Value = \"Greatest % Increase\"\r\n    ws.Range(\"N3\").Value = \"Greatest % Decrease\"\r\n    ws.Range(\"N4\").Value = \"Greatest Total Volume\"\r\n    ws.Range(\"O1\").Value = \"Ticker Name\"\r\n    ws.Range(\"P1\").Value = \"Value\"\r\n    \r\n    'Get for greatest increase, greatest increase, and  greatest volume Ticker name\r\n    ws.Range(\"O2\").Value = increase_name\r\n    ws.Range(\"O3\").Value = decrease_name\r\n    ws.Range(\"O4\").Value = greatest_name\r\n    ws.Range(\"P2\").Value = Increase\r\n    ws.Range(\"P3\").Value = Decrease\r\n    ws.Range(\"P4\").Value = Greatest\r\n    \r\n    'Greatest increase and decrease in percentage format\r\n    \r\n    ws.Range(\"P2\").NumberFormat = \"0.00%\"\r\n    ws.Range(\"P3\").NumberFormat = \"0.00%\"\r\n\r\n\r\n'--------------------------------------------------\r\n' Conditional formatting columns colors\r\n\r\n'The end row for column J\r\n\r\n    jEndRow = ws.Cells(Rows.Count, \"J\").End(xlUp).Row\r\n    \r\n\r\n        For j = 2 To jEndRow\r\n            \r\n            'if greater than or less than zero\r\n            If ws.Cells(j, 10) > 0 Then\r\n            \r\n                ws.Cells(j, 10).Interior.ColorIndex = 4\r\n                \r\n            Else\r\n            \r\n                ws.Cells(j, 10).Interior.ColorIndex = 3\r\n            End If\r\n            \r\n        Next j\r\n    \r\n'Excute to next worksheet\r\nNext ws\r\n'--------------------------------------------------\r\nEnd Sub\r\n\n"}]